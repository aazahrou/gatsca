---
title: "Android Push Notifications with GraphQL"
date: 2016-02-11 00:00:00 -0700
categories: Scaphold, Android, Push Notifications, GCM
description: "Using GraphQL to enable Android GCM push notifications for mobile devices in 4 easy steps."
photo: "https://assets.scaphold.io/community/blog/android-push-notifications-with-graphql/banner_gcm_push.png"
headshot: "https://assets.scaphold.io/images/vince.jpg"
author: "Vince Ning"
---

## Step-by-step guide on setting up Apple push notifications for your GraphQL backend

![GraphQL and Android Push Notifications](https://assets.scaphold.io/community/blog/android-push-notifications-with-graphql/banner_gcm_push.png)

Calling all Android mobile developers! Today, we’re going to walk you through how to set up Android push notifications for your GraphQL server.

> It’s about time for mobile to get some GraphQL love. ❤️

We’re going to cut right to the chase with the **3 steps** to get you set up right away with Android push notifications.

> Prerequisite: You must have an actual Android device configured for development.

# 1. Create a Google API project to enable GCM.

We’re going to start off by creating an Android app. To make it easier for you, we’ve provided a starter kit that goes along with this guide.

[**Download the starter kit here**](https://github.com/scaphold-io/android-gcm-push-graphql-starter-kit).

Once we’ve created the app, we’ll want to connect it to a Google project. Please go to your [Google Developer Console](https://console.cloud.google.com/apis) and **create a new project**.

![Create_Project](https://assets.scaphold.io/community/blog/android-push-notifications-with-graphql/Create_Project.png)

Once you’ve created your Google project, you’ll have to also create a new Firebase project at the [Firebase console](https://console.firebase.google.com/).

![Firebase_Console](https://assets.scaphold.io/community/blog/android-push-notifications-with-graphql/Firebase_Console.png)

> Why do we have to go to Firebase? Google now only provides GCM push notification support through the Firebase console. 😤

<div class="text-center">
  <img src="https://assets.scaphold.io/community/blog/android-push-notifications-with-graphql/Create_Firebase_App.png" alt="Create_Firebase_App" style="max-width: 50%" />
</div>

Follow the steps to finish creating your app, then **Add Firebase to your Android app**.

![Add_Firebase](https://assets.scaphold.io/community/blog/android-push-notifications-with-graphql/Add_Firebase.png)

We’ll need your **Package Name (or Application ID)**. Find your package name here in your app:

![Package_Name](https://assets.scaphold.io/community/blog/android-push-notifications-with-graphql/Package_Name.png)

The **nickname** is your choice. Your first step should look like this.

<div class="text-center">
  <img src="https://assets.scaphold.io/community/blog/android-push-notifications-with-graphql/Enter_App_Details.png" alt="Enter_App_Details" style="max-width: 50%" />
</div>

After adding the app, you’ll download a Google Service JSON file that you’ll need to import into your project. Place it in your **app** directory.

<div class="text-center">
  <img src="https://assets.scaphold.io/community/blog/android-push-notifications-with-graphql/Add_Google_Services_JSON.png" alt="Add_Google_Services_JSON" style="max-width: 50%" />
</div>

Great! Now you’ll need to update the following dependencies in your Android app.

- App-level *bundle.gradle*:

    ![Add_Dependencies_To_Gradle_1](https://assets.scaphold.io/community/blog/android-push-notifications-with-graphql/Add_Dependencies_To_Gradle_1.png)

- Project-level *bundle.gradle*:

    ![Add_Dependencies_To_Gradle_2](https://assets.scaphold.io/community/blog/android-push-notifications-with-graphql/Add_Dependencies_To_Gradle_2.png)

And finally, you’ll need to update your strings.xml constants file to reflect the App ID of the newly created Google project.

![Add_Project_Number](https://assets.scaphold.io/community/blog/android-push-notifications-with-graphql/Add_Project_Number.png)

> Nice work ✅ Your Android app and Google project are now connected!

# 2. Integrate your GraphQL server with GCM.

Now, it’s time to connect your GraphQL server with GCM so that you can actually send push notifications.

Let’s first grab your **Server API Key** that was auto-generated by Google after successful completion of the previous process of connecting your Android app with your Google project. You’ll need to find it in your Google Developer Console.

**Open up the left side panel** by clicking the top-left hamburger menu, and navigate to the **API Manager**.

![API_Console](https://assets.scaphold.io/community/blog/android-push-notifications-with-graphql/API_Console.png)

Now click the **Credentials** tab on the left-hand menu to grab your **Server API Key**. Save this. You’ll need it in the next step to connect to your GraphQL server.

![Server_API_Key](https://assets.scaphold.io/community/blog/android-push-notifications-with-graphql/Server_API_Key.png)

To make it easy, [Scaphold.io](https://scaphold.io) provides an easy way to set up your very own GraphQL server for free in minutes. [**Sign up for an account**](https://scaphold.io/?signupModal=true) and **create an app**. At this point, you instantly have a GraphQL server deployed in production, ready to make requests.

Now, go to Scaphold’s Integrations Portal to enable Android push notifications for development. **Click Add** to begin.

![Create_Integration_1](https://assets.scaphold.io/community/blog/android-push-notifications-with-graphql/Create_Integration_1.png)

A form will then pop up, asking for your **Server API Key**. Fill out the appropriate fields and **hit Create**.

<div class="text-center">
  <img src="https://assets.scaphold.io/community/blog/android-push-notifications-with-graphql/Create_Integration_2.png" alt="Create_Integration_2" style="max-width: 50%" />
</div>

Good job! You’ve now connected your GraphQL server to be able to send push notifications to devices with your app installed.

# 3. Obtain a device token to send push notifications.

In order to send a push notification to a device, we need to generate a device token that is a unique identifier for a device and an app together. In that case, we’ll need to install your app onto an actual Android device.

But first, we need to create an event handler to receive the device token once a user permits the app to send push notifications to their phone. In your app, you’ll need to put the following snippet in your ExternalReceiver file (i.e. class that extends BroadcastReceiver):

```
public class ExternalReceiver extends BroadcastReceiver {
  private void register() {
    new AsyncTask(){
      protected Object doInBackground(final Object... params) {
        String token;
        try {
          token = gcm.register(getString(R.string.project_number));
          Log.i("registrationId", token);
        }
        catch (IOException e) {
          Log.i("Registration Error", e.getMessage());
        }
        return true;
      }
    }.execute(null, null, null);
  }
}
```

We’re going to be using the [boilerplate code from earlier](https://github.com/scaphold-io/android-gcm-push-graphql-starter-kit) to illustrate.

Now install your app on your Android device by pressing the big ▶️ button in the top bar of Android Studio.

> Note: An actual device is needed since the simulator is transient and cannot have a device token associated to it.

Upon success, your device token will be issued by GCM and printed out in your Android Studio console.

![Device_Token](https://assets.scaphold.io/community/blog/android-push-notifications-with-graphql/Device_Token.png)

Save this device token and send it to Scaphold to register it on your behalf with GCM. This take the form of sending a GraphQL mutation from your app, but for demonstration purposes, we’ll use GraphiQL to do so.

![Create_Device_Token](https://assets.scaphold.io/community/blog/android-push-notifications-with-graphql/Create_Device_Token.png)

<hr />

Congratulations! You’ve successfully configured your app and device to be able to send and receive iOS push notifications. And the best part is that it was all done with GraphQL.

Now that your GraphQL server is set up for iOS push notifications, the next part of this guide will walk you through how to...

- Send push notifications
- Associate users to device tokens
- Manage push channels (i.e. groups)

**Thanks for following along! We'll walk you through sending your first push notification with GraphQL in [the next part of this tutorial](/blog/send-push-notifications-scaphold-graphql/).**

Looking for how to set up iOS push notifications with APNS? [Follow along here!](/blog/iOS-push-notifications-with-graphql/)

Enjoy how easy that was to set up a GraphQL server? [**Join Scaphold today!**](https://scaphold.io) And be sure to follow us on [Twitter](https://twitter.com/ScapholdDotIO) or join our [Slack](http://slack.scaphold.io/) for more awesome ways to learn about how to quickly launch your next app with GraphQL!